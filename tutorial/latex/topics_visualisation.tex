\subsubsection*{Quick visualizations from Python}

interactive plots...

\begin{lstlisting}[language=Python]
vp.plot_plant(plant)
\end{lstlisting}

\subsubsection*{How to export plant geometry for later visualization} \label{ssec:export}

There are various ways to export plant geometry for later visualization, or to use the geometry as mesh for other simulation software.

The Plant class provides outputs in RSML (), VTP (), and for paraview python scripts for the soil container geometry. Each organ is represented as a polyline with additional data given for each organ/polyline.

\begin{lstlisting}[language=Python]
plant.write("myfile.rsml")
plant.write("myfile.vtp")
plant.write("myfile.py")
\end{lstlisting}

The SegmentAnalyser class provides outputs in VTP (), DGF (), and text files. The Plant organs are represented by their segments.
\begin{lstlisting}[language=Python]
ana = pb.SegmentAnalyser(plant)
ana.write("myfile.vtp")
ana.write("myfile.dgf")
\end{lstlisting}


The interactive plotting tools are based on VTK and it is easy to write the resulting geometries as VTP in a binary format resulting in smaller file size. The organs are represented as polylines, the
\begin{lstlisting}[language=Python]
vp.write_plant(plant)
\end{lstlisting}
TODO there are file formats supported, e.g. mesh


The class PlantVisualizer can ...




\subsubsection*{Paraview}

how to run the macros... and render the geometry


\subsubsection*{How to make an animation} \label{ssec:animation}

In order to create an animation in Paraview we have to consider some details. The main idea is to export the result file as segments using the class SegmentAnalyser. A specific frame is then obtained by thresholding within Paraview using the segments creation times. In this way we have to only export one vtp file. 

We modify example1b.py to demonstrate how to create an animation.

\lstinputlisting[language=Python, caption=Example 4c (modified from Example 1b)]{examples/example3e_animation.py} 

\begin{itemize}

\item[11,12] Its important to use a small resolution in order to obtain a smooth animation. L18 set the axial resolution to 0.1 cm. 

\item[19,29] Instead of saving the root system as polylines, we use the SegmentAnalyser to save the root system as segments.

\item[22,23] It is also possible to make the root system periodic in the visualization in $x$ and $y$ direction to mimic field conditions.

\item[26-28] We save the geometry as Python script for the visualization in ParaView.

\end{itemize}

After running the script we perform the following operations Paraview to create the animation:
\begin{enumerate}
 \item Open the .vtp file in ParaView (File$\rightarrow$Open...), and open tutorial/examples/python/results/example\_3e.vtp.
 \item Optionally, create a tube plot with the help of the script tutorial/pyscript/rsTubePlot.py (Tools$\rightarrow$Python Shell, press 'Run script').
 \item Run the script tutorial/pyscript/rsAnimate.py (Tools$\rightarrow$Python Shell, press 'Run script'). The script creates the threshold filter and the animation. 
 \item Optionally, visualize the domain boundaries by running the script tutorial/examples/python/results/example\_4e.py (Tools$\rightarrow$Python Shell, press 'Run script'). Run after the animation script (otherwise it does not work).  
 \item Use File$\rightarrow$Save Animation... to render and save the animation. Pick quality ($<$100 \%), and the frame rate in order to achieve an appropriate video length, e.g. 300 frames with 50 fps equals 6 seconds. The resulting files might be uncompressed and are very big. The file needs compression, for Linux e.g. ffmpeg -i in.avi -vcodec libx264 -b 4000k -an out.avi, produces high quality and tiny files, and it plays with VLC.
\end{enumerate}

